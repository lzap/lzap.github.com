---
layout: post
title: Logování přes Commons Logging
date: 2010-04-23
tags:
- oldblog
---

<h1>{{ page.title }}</h1>
<i><span class="Apple-style-span" style="font-style: normal;"></span></i><br /><i><h1><span class="Apple-style-span" style="font-size: medium; font-weight: normal;"><i><span class="Apple-style-span" style="font-style: normal;"><div class="level1" style="display: inline !important;"><div style="display: inline !important;">Vždycky se na pár desítek minut zarazím, když potřebuji vytvořit pro nějakou aplikaci triviální logování pomocí Jakarta Commons Logging knihovny za použití logovacího subsystému z JRE 1.4 nebo vyšší. Bohužel dokumentace k oběma&nbsp;<acronym title="Application Programming Interface">API</acronym>&nbsp;neobsahuje žádný příklad, takže obvykle hledám na internetu nebo ve starých projektech. Raději to tedy napíšu na svůj blog, abych to příště nehledal…</div></div></span></i></span></h1><h2><a href="" id="commons-loggingproperties" name="commons-loggingproperties">commons-logging.properties</a></h2><div class="level2"><pre class="code">org.apache.commons.logging.Log=org.apache.commons.logging.impl.Jdk14Logger</pre><pre class="code"></pre>Použije logovací subsystém z Javy. Rád využívám složeb tohoto&nbsp;<acronym title="Application Programming Interface">API</acronym>, protože nač přidávat k projektu další knihovnu (např. Log4J)? Lze také specifikovat factory třídu, která se použije, ale toto není nutné:<br /><br /><pre class="code">org.apache.commons.logging.Log=org.apache.commons.logging.impl.Jdk14Logger<br />org.apache.commons.logging.LogFactory=org.apache.commons.logging.impl.LogFactoryImpl</pre><pre class="code"></pre>Zajímavé je, že knihovna commons-logging automaticky použije&nbsp;<acronym title="Java Development Kit">JDK</acronym>&nbsp;1.4 logger, pokud není nakonfigurována jinak a pokud v CLASSPATH nenajde knihovnu log4j (které dává přednost). Bohužel tuto knihovnu často v CLASSPATH mám kvůli závislostem, proto je třeba commons-logging explicitně nastavit.</div><h2><a href="" id="loggingproperties" name="loggingproperties">logging.properties</a></h2><div class="level2"><pre class="code">handlers = java.util.logging.ConsoleHandler,java.util.logging.FileHandler<br />formatters=java.util.logging.SimpleFormatter<br /><br />.level = ALL<br />java.util.logging.ConsoleHandler.level = SEVERE<br />java.util.logging.FileHandler.level = INFO<br /><br />java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter<br /><br />java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter<br />java.util.logging.FileHandler.pattern = APLIKACE.log</pre><pre class="code"></pre>Jednoduchá konfigurace – na konzoli se vypisují jen chyby, do souboru APLIKACE.log pak info hlášky. Tento soubor můžete uložit třeba do domovského adresáře uživatele (pomocí masky %u) – více info u dokumentaci třídy FileHandler.</div><h2><a href="" id="nastaveni_pomoci_promennych" name="nastaveni_pomoci_promennych">Nastavení pomocí proměnných</a></h2><div class="level2">Úroveň logování lze také nastavit pomocí systémové proměnné Javy:&nbsp;<strong>org.apache.commons.logging.Log</strong>. Můžete ji nastavit na příkazové řádce parametrem -D, nebo z programu (System.setProperty). Dostupné loggery (volby) v implementaci commons-logging verze 1.1 jsou:<br /><ul><li class="level1"><div class="li">org.apache.commons.logging.impl.AvalonLogger</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.Jdk13LumberjackLogger</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.Jdk14Logger</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.Log4JLogger</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.LogKitLogger</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.NoOpLog</div></li><li class="level1"><div class="li">org.apache.commons.logging.impl.SimpleLog</div></li></ul>Poslední jmenovaný implementuje jednoduché logování na standardní/chybový výstup (není nutná žádná přídavná knihovna). Předposlední jmenovaný logger je takzvaný nulový – všechny logy se zahazují. Pro Log4j nebo LogKit volby je potřeba mít v CLASSPATH adekvátní knihovny, u&nbsp;<acronym title="Java Development Kit">JDK</acronym>&nbsp;1.4 loggeru je nutné mít potřebnou verzi JRE (1.4+). Příklad spuštění programu, u kterého chcete zcela vypnout logování (za předpokladu, že program loguje pouze přes commons-logging fasádu):<br /><br /><pre class="code">java -Dorg.apache.commons.logging.Log=org.apache.commons.logging.impl.NoOpLog -cp . cz.app.MyApp</pre><pre class="code"></pre>Další informace o nastavení logování přes commons-logging jsou v oficiální dokumentaci:&nbsp;<a class="urlextern" href="http://commons.apache.org/logging/guide.html#Configuration" rel="nofollow" title="http://commons.apache.org/logging/guide.html#Configuration">http://commons.apache.org/logging/guide.html#Configuration</a></div></i><br /><i><br /></i><br /><i>Tento zápisek vznikl převodem z mého starého blogu. Ne všechny texty byly takto převedeny, kompletní archiv najdete v <a href="http://static.zapletalovi.com/oldblog">HTML archivu</a>.</i>