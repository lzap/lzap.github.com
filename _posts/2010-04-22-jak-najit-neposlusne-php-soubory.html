---
layout: post
title: Jak najít neposlušné PHP soubory
date: 2010-04-22
tags:
- oldblog
---

<h1>{{ page.title }}</h1>
<div class="dokuwiki export">    <h1><a href="" id="jak_najit_neposlusne_php_soubory" name="jak_najit_neposlusne_php_soubory"></a></h1><div class="level1">    Snad každému programátorovi, který kdy dělal v <acronym title="Hypertext  Preprocessor">PHP</acronym>, se stalo, že program nemohl nastavit <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> hlavičky, protože  už na výstup bylo něco zapsáno. V drtivé většině případů je tam zapsán  nějaký bílý znak, který se omylem zatoulá za konečnou sekvencí <strong>?&gt;</strong>.  Snadná pomoc, vůbec neuvádějte závěrečnou sekvenci, protože je zcela  nepovinná. Pokud se jedná o soubory, které obsahují čistý kód (při  použití Smarty nebo jiného šablonovacího systému to jsou všechny soubory  typu <acronym title="Hypertext Preprocessor">PHP</acronym>), tak na  poslední řádek dávejte něco jiného. <br />Následující příkaz vyhledá všechny <acronym title="Hypertext  Preprocessor">PHP</acronym> soubory, které nemají na posledním řádku <strong>//  EOF</strong> nebo <strong>//EOF</strong>:<br /><br /><pre class="code bash"><span class="kw2">find</span> . <span class="re5">-type</span> f <span class="re5">-name</span> <span class="st_h">'*php'</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw2">read</span> f ;<span class="kw1">do</span> <span class="kw2">tail</span> <span class="re5">-1</span> <span class="st0">"<span class="es2">$f</span>"</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-vsqE</span> <span class="st_h">'// ?EOF'</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">echo</span> <span class="st0">"<span class="es2">$f</span>"</span> ;<span class="kw1">done</span></pre><br />A následující příkaz vyhledá <acronym title="Hypertext Preprocessor">PHP</acronym>  soubory, které začínají jinak než <strong>:&nbsp;</strong><br /><br /><pre class="code bash"><span class="kw2">find</span> . <span class="re5">-type</span> f <span class="re5">-name</span> <span class="st_h">'*php'</span> <span class="sy0">|</span> <span class="kw2">xargs</span> <span class="kw2">grep</span> <span class="re5">-n</span> <span class="st_h">' <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">':1:'</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-v</span> <span class="st_h">' <span class="sy0">|</span> <span class="kw2">sed</span> <span class="st_h">'s/:1:</span></span></span></pre></div></div><br /><i>Tento zápisek vznikl převodem z mého starého blogu. Ne všechny texty byly takto převedeny, kompletní archiv najdete v <a href="http://static.zapletalovi.com/oldblog">HTML archivu</a>.</i>