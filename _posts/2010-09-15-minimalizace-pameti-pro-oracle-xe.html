---
layout: post
title: Minimalizace paměti pro Oracle XE
date: 2010-09-15
tags:
- oracle
---

<h1>{{ page.title }}</h1>
Nastavit minimum paměti pro Oracle XE instanci je snadné. Pokud používáte <a href="http://www.dba-oracle.com/concepts/pfile_spfile.htm">SPFILE</a> (doporučeno, zejména pokud pracujete přes APEX), můžete parametry nastavit rovnou "<a href="http://www.orafaq.com/wiki/SGA_target">z fleku</a>". Jako sysdba je potřeba provést:<br /><br /><pre>SQL> show parameters sga<br /><br />NAME         TYPE  VALUE<br />------------------------------------ ----------- ------------------------------<br />lock_sga        boolean  FALSE<br />pre_page_sga        boolean  FALSE<br />sga_max_size        big integer 950M<br />sga_target        big integer 800M<br /><br />SQL> alter system set sga_max_size=300m scope=spfile;<br /><br />System altered.<br /><br />SQL> alter system set sga_target=300m;               <br /><br />System altered.<br /><br />SQL> show parameters pga;<br /><br />NAME         TYPE  VALUE<br />------------------------------------ ----------- ------------------------------<br />pga_aggregate_target       big integer 200M<br /><br />SQL> alter system set pga_aggregate_target=80m;<br /><br />System altered.</pre><br />Doporučená minimální hodnota pro nějaké to experimentování je 400 MB pro SGA a 100 MB pro PGA. Doporučuji nastavit také hodnotu sga_max_size, abyste si byli jisti, že tuhle hodnotu Oracle nepřekročí. Případně ji můžete nastavit o něco výše než je sga_target a doufat, že bude mít databáze paměti dost a vejde se to nařízeného cílového stavu.<br /><br />Menší hodnoty při jenom trošku náročnějším používání mohou skončit také tak, že se Oracle XE "zasekne" a nepůjde shodit init skriptem ani standardní cestou. V případě "zaseknutí" je nutné přihlásit se jako uživatel "oracle", nastavit si potřebné proměnné a provést SHUTDOWN ABORT.<br /><br /><pre>export ORACLE_BASE=/usr/lib/oracle/xe/app/oracle<br />export ORACLE_HOME=$ORACLE_BASE/product/10.2.0/server<br />export LD_LIBRARY_PATH=$ORACLE_HOME/lib<br />export PATH=$PATH:$ORACLE_HOME/bin<br />export ORACLE_SID=XE<br /><br />$ sqlplus / as sysdba<br /><br />SQL*Plus: Release 10.2.0.1.0 - Production on Wed Sep 15 14:09:42 2010<br /><br />Copyright (c) 1982, 2005, Oracle.  All rights reserved.<br /><br />Connected.<br />SQL> SHUTDOWN ABORT</pre><br />Pakliže preferujete PFILE konfiguraci, stačí poeditovat soubor <i>/usr/lib/oracle/xe/app/oracle/product/10.2.0/server/dbs/init.ora</i>. Pozor! Nesplést se souborem <i>/usr/lib/oracle/xe/app/oracle/product/10.2.0/server/config/scripts/init.ora</i>! V souboru nastavte tyto hodnoty:<br /><br /><pre># 100 MB minimum (100000000), default 805306368<br />sga_target=400000000<br />sga_max_size=400000000<br /><br /># 20 MB minimum (20000000), default 268435456<br />pga_aggregate_target=100000000</pre><br />Ujistěte se, že instance nepoužívá SPFILE soubor (u Oracle XE je to vždy spfileXE.ora). Pokud tento soubor existuje, init.ora se nepoužije a musíte hodnoty nastavovat výše uvedeným způsobem.