---
layout: post
title: Bolí vás z autotools hlava? Zkuste waf!
date: 2010-06-01
tags:
- waf
- linux
- unix
---

<h1>{{ page.title }}</h1>
Přiznám se, že autotools znám jen zběžně. Používat jej (configure &amp; make &amp; make install) umím, vytvořit menší projekt o několika souborech také. Ale "hrabat" se ve velkém projektu plném vychytávek a jiných maker, tak to jsem doslova obestlaný manuály, dokumentací a info stránkami. Existuje něco podobně mocného, jako autotools, ale přesto přenositelného a se stejnými možnostmi? Ano. Waf.<br /><br />Obrovskou výhodou autotools (jinými slovy ./configure &amp; make &amp; make install) je fakt, že ke svému běhu potřebují jen shell (sh). Díky autotools lze kompilovat programy na odlišných UNIXových systémech i jinde. Dnes je situace jiná - není třeba zas tak velké přenositelnosti. Typicky se autor programu snaží docílit překladu na Linuxu, MacOS a Windows. Když se program přeloží bez větších obtíží na BSD, je to bonus. Shell jako minimum je prostě overkill. Waf potřebuje jen Python, který k němu lze snadno přiložit.<br /><br />Tématem zápisku je <a href="http://code.google.com/p/waf/">waf</a> - miniaturní skript (méně než 100 kB), který ke svému běhu potřebuje pouze interpret Pythonu verze 2.3 nebo vyšší (až do verze 3.1), případně Jython. To řada systémů splňuje bez problémů, případně lze Python k programu připojit (např jython.jar).<br /><br />V tomto jediném souboru (skriptu) je všechno, co potřebujete. Po prvním spuštění se Waf rozbalí do skrytého adresáře s projektem&nbsp;(.waf-verze-hash - jsou to soubory v Pythonu) a poté se již nerozbaluje. Umí vše, co se od takového nástroje očekává.<br /><br />Skript waf je&nbsp;<a href="http://freehackers.org/~tnagy/wafbook/index.html">velice mocný</a>&nbsp;a plně zastoupí autotools (autoconf, automake, configure, make, make install). Psaní build skriptů je snadné, k základům postačí pár minut čtení dokumentace.<br /><br />Waf přináší mnoho nových a zajímavých vlastností. Kromě nadstandardních balíčkovacích a testovacích možností nabízí napojení na server kontinuální integrace. Můžete si aktivovat vlastní ccache, nebo si nastavit barvy výstupu na konzoli včetně progress baru. Waf je vysoce rozšiřitelný a pokud umíte základy Pythonu, psaní build skriptů bude hračkou.<br /><br />Na několika velkých projektech jsem si již ověřil, že jakmile se posunete za hranice obyčejného sestavování a chcete víc, vždy se pak snažíte "naroubovat" jiné nástroje a postupy na utility typu GNU Make nebo Apache Maven/Ant. Výsledky pak někdy nejsou ideální. Waf je na budoucí rozšiřování nejen připraven, on vlastně k tomu svým návrhem vybízí. A díky Pythonu jsou skripty lépe přenositelné než kdy jindy.<br /><br />Když už začnete experimentovat s Wafem, zkuste také velmi pěkné odlehčené programovací prostředí (IDE) pojmenované Geanie. Je podobně jako Waf nenáročné, přesto nabízí mnoho zajímavých funkcí. Ačkoli s Wafem nesouvisí, při brouzdání jsem na něj narazil.<br /><br />Waf je zajjímavý nástroj a možná může vyřešit váš problém.