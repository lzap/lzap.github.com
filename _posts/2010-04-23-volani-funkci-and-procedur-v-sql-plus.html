---
layout: post
title: Volání funkcí and procedur v SQL*Plus
date: 2010-04-23
tags:
- oldblog
---

<h1>{{ page.title }}</h1>
Nejprve zjistíme hlavičku dané procedury.<br /><br />DESC MY_PROCEDURE;<br /><br />Příkaz DESCRIBE (DESC) lze v Oracle použít kromě tabulek, indexů a jiných objektů také na funkce a procedury. V dřívějších verzích jej šlo použít i na procedury v balíčcích, bohužel tato funkcionalita byla z novějších verzí odstraněna, takže následující příklad nebude<br />fungovat.<br /><br />DESC MY_PACKAGE.MY_PROCEDURE; -- chyba ORA-04043<br /><br />Pokud tedy potřebujeme zjistit informace o proceduře z balíčku, jako nejjednodušší se jeví provést příkaz describe přímo na balíčku.<br /><br />DESC MY_PACKAGE;<br /><br />Poté z delšího výpisu (záleží na počtu funkcí a procedur) vyčíst potřebné informace. Existuje pochopitelně i jiná možnost – vyhledat si informaci přímo v metadatech. Bylo by to nějak<br />takto (jména objektů musejí být velkými písmeny):<br /><br />SELECT ARGUMENT_NAME, IN_OUT, DATA_TYPE FROM ALL_ARGUMENTS WHERE <br />PACKAGE_NAME = 'MY_PACKAGE' AND<br />OBJECT_NAME = 'MY_PROCEDURE'<br />ORDER BY POSITION;<br /><br />Nyní můžeme volat proceduru, která má kupříkladu jeden IN parametr a tři OUT. To se provede<br />takto.<br /><br />VARIABLE P1 VARCHAR2(250);<br />VARIABLE P2 VARCHAR2(250);<br />VARIABLE P3 VARCHAR2(250);<br />VARIABLE P4 VARCHAR2(250);<br />CALL MY_PACKAGE.MY_PROCEDURE(:P1, :P2, :P3, :P4)<br />PRINT P2<br />PRINT P3<br />PRINT P4<br /><br />Druhá možnost je vytvořit si anonymní blok v PL/SQL a proceduru zavolat podobným způsobem. Namísto příkazů VARIABLE/PRINT se však použije syntaxe PL/SQL a výpis do výstupu serveru pomocí DBMS_OUTPUT.PUT_LINE.<br /><br />SET SERVEROUTPUT ON;<br />DECLARE<br />P1 VARCHAR(250);<br />...<br />BEGIN<br />P1 := 'xxxx';<br />MY_PACKAGE.MY_PROCEDURE(PARAM1 =&gt; P1, ...)<br />DBMS_OUTPUT.PUT_LINE(P1)<br />...<br />END;    <br /><br />Některé nástroje usnadňují vytvoření výše uvedeného stubu, například v SQL Developeru můžete proceduru chytnout a přetáhnout ji do sheetu. Musíte však přidat DBMS_OUTPUT volání a aktivovat výstupní konzoli (okno Dbms Output).<br /><br /><i>Tento zápisek vznikl převodem z mého starého blogu. Ne všechny texty byly takto převedeny, kompletní archiv najdete v <a href="http://static.zapletalovi.com/oldblog">HTML archivu</a>.</i>