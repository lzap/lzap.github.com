---
layout: post
title: How to use RHN Certificate-Based Subscription Management in RHEL 6.1
date: 2011-08-27
tags:
- redhat
- katello
- rhn
---

<h1>{{ page.title }}</h1>
Prominent change in the new Red Hat Enterprise Linux 6.1 is brand new subscription management. While RHEL 6.1 still include the classic RHN tools and commands (rhn_register, rhnreg_ks and others), it is also possible to use the new <b>RHN Certificate-Based Subscription Management</b>. In this article, I am going to go through all the required steps of sucessful registration and subscription of a RHEL 6.1 system.<br /><br />First of all make sure you did not use the classic RHN before you procced with the tutorial. To unregister a machine, just delete this file:<br /><br /><i># rm /etc/sysconfig/rhn/systemid</i><br /><br />You can also log in to the <a href="https://rhn.redhat.com">RHN site</a> and delete the system there. Now, we are going to subscribe using the new method.<br /><br />If you do have a graphical desktop on the machine you can use <a href="http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/launching-ents-tools.html">subscription-manager-gui</a> tool which has pretty sleek interface and provides you with all the required steps. My primary target is to show process of registering using command line tool subscription-manager.<br /><br />The first step is to register a machine. The following command identifies our system to the subscription service:<br /><br /><i># subscription-manager register</i><br /><br />You are asked for your RHN login credentials (username and password). You can also provide some additional options like <i>name</i> (custom system name instead of hostname), <i>autosubscribe</i> (to automatically subscribe) or <i>force</i> (to unregister machine if it was already registered). We won't use any options in our tutorial.<br /><br />You can now login to the <a href="https://access.redhat.com">access.redhat.com</a> site and visit brand new section Subscriptions - CERTIFICATE-BASED MANAGEMENT to see the system (consumer in the terms of RHN).<br /><br />Let's display all of the subscriptions that are compatible with the machine, either subscriptions that are actually consumed by the machine or unused subscriptions that are available to the machine:<br /><br /><i># subscription-manager list</i><br /><br />The next step is to consume a subscription. You need to provide pool id using the <i>pool</i> argument, or <i>auto</i> option to determine subscription according to the installed system. In our case the command would be:<br /><br /><i># subscription-manager subscribe --auto</i><br /><br />We are done, the system is registered and yum should deliver packages and updates via new Red Hat Content Delivery Network, resulting in significantly faster download speeds. You can also disable the classic RHN yum plugin if you want by editing <i>/etc/yum/pluginconf.d/rhnplugin.conf</i> and setting enabled to 0.<br /><br />For more info read the <a href="http://docs.redhat.com/docs/en-US/Red_Hat_Customer_Portal/1/pdf/Red_Hat_Network_Certificate-based_Subscription_Management/Red_Hat_Customer_Portal-1-Red_Hat_Network_Certificate-based_Subscription_Management-en-US.pdf">Red Hat Network Certificate-based Subscription Management</a> user guide (PDF link).