<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Fedora 31 and AMD Radeon 5600 XT</title><meta name=description content="engineer in pyjama"><meta name=keywords content="blog,lzap,lukáš,zapletal,linux,tech,fedora"><meta property="og:url" content="https://blog.zapletalovi.com/posts/2020-03-04-fedora-31-and-amd-radeon-5600-xt/"><meta property="og:type" content="website"><meta property="og:title" content="Fedora 31 and AMD Radeon 5600 XT"><meta property="og:description" content="engineer in pyjama"><meta property="og:image" content="/images/avatar_rh_512.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Fedora 31 and AMD Radeon 5600 XT"><meta name=twitter:description content="engineer in pyjama"><meta property="twitter:domain" content="https://blog.zapletalovi.com/posts/2020-03-04-fedora-31-and-amd-radeon-5600-xt/"><meta property="twitter:url" content="https://blog.zapletalovi.com/posts/2020-03-04-fedora-31-and-amd-radeon-5600-xt/"><meta name=twitter:image content="/images/avatar_rh_512.jpg"><link rel=canonical href=https://blog.zapletalovi.com/posts/2020-03-04-fedora-31-and-amd-radeon-5600-xt/><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://blog.zapletalovi.com/css/dark.css><script src=https://blog.zapletalovi.com/js/svg-injector.min.js></script>
<script src=https://blog.zapletalovi.com/js/feather-icons.min.js></script>
<script src=https://blog.zapletalovi.com/js/main.js></script>
<script type=text/javascript>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-16034952-1"]),_gaq.push(["_trackPageview"]),function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}()</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.zapletalovi.com><img src=https://blog.zapletalovi.com/images/avatar_rh_512.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.zapletalovi.com>Lukáš Zapletal</a></div><div class=nav-links><div class=nav-link><a href=https://blog.zapletalovi.com/posts/>Posts</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/me/>About me</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/contact/>Contact</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/tags/>Tags</a></div><div class=nav-link><a href=https://github.com/lzap><span data-feather=github></span></a></div><div class=nav-link><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></div><div class=nav-link><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></div><div class=nav-link><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></div><div class=nav-link><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.zapletalovi.com/posts/>Posts</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/me/>About me</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/contact/>Contact</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/tags/>Tags</a></li><li class=nav-item><a href=https://github.com/lzap><span data-feather=github></span></a></li><li class=nav-item><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></li><li class=nav-item><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></li><li class=nav-item><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></li><li class=nav-item><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Fedora 31 and AMD Radeon 5600 XT</h1><small role=doc-subtitle></small><p class=post-date>March 4, 2020</p><ul class=post-tags><li class=post-tag><a href=https://blog.zapletalovi.com/tags/linux>linux</a></li><li class=post-tag><a href=https://blog.zapletalovi.com/tags/fedora>fedora</a></li></ul></div><div class=post-content><p><p>I have upgraded my RX 560 to much more powerful 5600 XT. Thanks to 7nm
technology, this beast draws 7W on idle and both fans are turned off similarly
to my old 560 (4W idle) while it can deliver robust performance up to 160W
after BIOS update (I have the launch model before AMD knew about NVidia price
cuts).</p><p>When I booted my Fedora 31 however, I did not get it into X.Org with i3 wm. The
system freezed during boot with:</p><pre><code>kernel: amdgpu 0000:0c:00.0: [gfxhub] page fault (src_id:0 ring:221 vmid:1 pasid:32769, for process Xorg pid 2022 thread Xorg:cs0 pid 2869)
kernel: amdgpu 0000:0c:00.0:   in page starting at address 0x0000800000010000 from client 27
kernel: amdgpu 0000:0c:00.0: GCVM_L2_PROTECTION_FAULT_STATUS:0x001009BA
kernel: amdgpu 0000:0c:00.0:          MORE_FAULTS: 0x0
kernel: amdgpu 0000:0c:00.0:          WALKER_ERROR: 0x5
kernel: amdgpu 0000:0c:00.0:          PERMISSION_FAULTS: 0xb
kernel: amdgpu 0000:0c:00.0:          MAPPING_ERROR: 0x1
kernel: amdgpu 0000:0c:00.0:          RW: 0x0
</code></pre><p>Luckily enough, upgrading kernel to latest one with AMD firmware does help.
Worry do not, I am going to show you how to upgrade only kernel, modules and
firmware from Fedora Rawhide (development version of Fedora essentially) while
keeping the rest of the system at the stable versions. Once OS is updated to
newever version, with kernel and modules matching the installed version they
will start updating again.</p><p>To do this, configure Fedora Rawhide repository as a disabled one:</p><pre><code># cat &gt;/etc/yum.repos.d/fedora-rawhide.repo &lt;&lt;EOF
[rawhide]
name=Fedora - Rawhide - Developmental packages for the next Fedora release
failovermethod=priority
baseurl=http://download.fedoraproject.org/pub/fedora/linux/development/rawhide/$basearch/os/
metalink=https://mirrors.fedoraproject.org/metalink?repo=rawhide&amp;arch=$basearch
enabled=0
metadata_expire=6h
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$basearch file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False

[rawhide-debuginfo]
name=Fedora - Rawhide - Debug
failovermethod=priority
metalink=https://mirrors.fedoraproject.org/metalink?repo=rawhide-debug&amp;arch=$basearch
enabled=0
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$basearch file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False

[rawhide-source]
name=Fedora - Rawhide - Source
failovermethod=priority
metalink=https://mirrors.fedoraproject.org/metalink?repo=rawhide-source&amp;arch=$basearch
enabled=0
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$basearch file:///etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-$releasever-$basearch
skip_if_unavailable=False
EOF
</code></pre><p>To install packages from Rawhide repository, it must be explicitly enabled:</p><pre><code>dnf --enablerepo=rawhide upgrade kernel linux-firmware
</code></pre><p>This will be probably enough for you, however I noticed that there were several
changes upstream this week in regard to AMD Radeon firmware, so I did one step
and copied over amdgpu firmware files over the update just for case. Chances
are you don&rsquo;t need to do this, in case your system won&rsquo;t boot try it. It is
harmless, once linux-firmware package is updated, these changed files will be
overwritten:</p><pre><code>git clone --depth 1 git://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git    
/usr/bin/cp -f linux-firmware/amdgpu/*bin /usr/lib/firmware/amdgpu/
</code></pre><p>After reboot, the system is back. My current kernel is
kernel-5.6.0-0.rc4.git0.1.fc33.x86_64 and if it&rsquo;s stable enough I am going to
stick with it until Fedora 33 upgrade. My firmware files are from March 2nd
2020 (commit 0148cfefcbf98898ca65bb26d9d7d638b30e211d) as the current ones in Rawhide
are sligtly older (linux-firmware-20200122-105.fc32.src.rpm).</p><p>As a reminder, to exclude some packages from updates, simply add the following
line to DNF configuration:</p><pre><code>cat &gt;/etc/dnf/dnf.conf &lt;&lt;EOF
exclude=kernel* linux-firmware
END
</code></pre><p>Remember to remove the line when upgrading to Fedora 32 at the end of May 2020!
This release is expected to have kernel 5.6.0 final release, or higher. For
sure it will have firmware files updated as well.</p><p>Until next time!</p></p></div></div></main><footer class=footer><span>&copy; 2022 Lukáš Zapletal, CC BY 4.0</span>
<span>Built with <a href=https://gohugo.io>hugo</a>, template <a target=_blank href=https://github.com/526avijitgupta/gokarna>gokarna</a></span></footer></body></html>