<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>ASUS B350 PLUS EFI settings for Linux</title><meta name=description content="engineer in pyjama"><meta name=keywords content="blog,lzap,lukáš,zapletal,linux,tech,fedora"><meta property="og:url" content="https://blog.zapletalovi.com/posts/2020-08-05-asus-b350-plus-efi-settings-for-linux/"><meta property="og:type" content="website"><meta property="og:title" content="ASUS B350 PLUS EFI settings for Linux"><meta property="og:description" content="engineer in pyjama"><meta property="og:image" content="/images/avatar_rh_512.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="ASUS B350 PLUS EFI settings for Linux"><meta name=twitter:description content="engineer in pyjama"><meta property="twitter:domain" content="https://blog.zapletalovi.com/posts/2020-08-05-asus-b350-plus-efi-settings-for-linux/"><meta property="twitter:url" content="https://blog.zapletalovi.com/posts/2020-08-05-asus-b350-plus-efi-settings-for-linux/"><meta name=twitter:image content="/images/avatar_rh_512.jpg"><link rel=canonical href=https://blog.zapletalovi.com/posts/2020-08-05-asus-b350-plus-efi-settings-for-linux/><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://blog.zapletalovi.com/css/dark.css><script src=https://blog.zapletalovi.com/js/svg-injector.min.js></script>
<script src=https://blog.zapletalovi.com/js/feather-icons.min.js></script>
<script src=https://blog.zapletalovi.com/js/main.js></script>
<script type=text/javascript>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-16034952-1"]),_gaq.push(["_trackPageview"]),function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}()</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.zapletalovi.com><img src=https://blog.zapletalovi.com/images/avatar_rh_512.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.zapletalovi.com>Lukáš Zapletal</a></div><div class=nav-links><div class=nav-link><a href=https://blog.zapletalovi.com/posts/>Posts</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/me/>About me</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/contact/>Contact</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/tags/>Tags</a></div><div class=nav-link><a href=https://github.com/lzap><span data-feather=github></span></a></div><div class=nav-link><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></div><div class=nav-link><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></div><div class=nav-link><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></div><div class=nav-link><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.zapletalovi.com/posts/>Posts</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/me/>About me</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/contact/>Contact</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/tags/>Tags</a></li><li class=nav-item><a href=https://github.com/lzap><span data-feather=github></span></a></li><li class=nav-item><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></li><li class=nav-item><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></li><li class=nav-item><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></li><li class=nav-item><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>ASUS B350 PLUS EFI settings for Linux</h1><small role=doc-subtitle></small><p class=post-date>August 5, 2020</p><ul class=post-tags><li class=post-tag><a href=https://blog.zapletalovi.com/tags/linux>linux</a></li><li class=post-tag><a href=https://blog.zapletalovi.com/tags/fedora>fedora</a></li></ul></div><div class=post-content><p><p>It&rsquo;s been two years on my Ryzen 1700, 32GB RAM and Saphire 5600XT however after
Fedora reinstallation after (another) SSD failure I started experiencing random
hangs of the graphical subsystem (I could still ssh to my workstation). Some
people recommended turning off IOMMU, so I took the opportunity to upgrade to
latest EFI firmware and review all my settings. These are the best (and safest)
ASUS B350-PLUS changed firmware settings optimized for Linux from my own
experience.</p><ul><li>CPU\SVM = Enabled</li><li>CPU\SMT = Disabled</li><li>AMD CBS\C-State = Disabled</li><li>AMD CBS\IOMMU = Disabled</li><li>Boot\Fast boot = Disabled</li><li>Boot\Boot logo = Disabled</li><li>Boot\POST delay = 2 sec</li><li>Boot\Wait for F1 = Disabled</li><li>Boot\Setup mode = Advanced</li></ul><p>This solves several issues I had in the past. Virtualization is turned off by
default, SVM enables it. Multi-threading is enabled and although this is not a
thread on AMD CPUs I like to turn this off as it caused some issues in the
past. C-State and IOMMU can be problematic for AMD GPUs and the rest is just
optimizing boot process for my LG screen as it does poweroff sometimes when
using Fastboot.</p><p>I also have
<a href=https://github.com/qrwteyrutiyoup/ryzen-stabilizator>ryzen-stabilizator</a>
script during the boot to turn off few more CPU flags to prevent from random
MCE freezing. It looks like after a month of testing, I haven&rsquo;t experienced
freeze without this but I am sticking with it for now:</p><pre><code># cat /etc/rc.d/rc.local
#!/bin/sh
/usr/local/bin/ryzen-stabilizator --disable-c6 --disable-boosting --disable-aslr -enable-psicworkaround
</code></pre><p>The author of this tool suggests to set Power Supply Idle Control to Typical
Current Idle, however I was not able to find this setting in my firmware.
Finally, my graphics card is constantly waking up my screen every 30 seconds,
there seem to be some problem with power with the latest drivers or firmware.
The workaround is to add <code>amdgpu.runpm=0</code> on the kernel commands line. This GPU
draws 6 watts on idle anyway with fans completely turned off.</p><p>I will update this blogpost on the fly if I encounter any other instability of
my setup in the future. Overall, I am quite happy with AMD-only hardware. Sure,
it&rsquo;s not as stable as Intel, but I am glad there&rsquo;s a competition again in the
industry.</p></p></div></div></main><footer class=footer><span>&copy; 2022 Lukáš Zapletal, CC BY 4.0</span>
<span>Built with <a href=https://gohugo.io>hugo</a>, template <a target=_blank href=https://github.com/526avijitgupta/gokarna>gokarna</a></span></footer></body></html>