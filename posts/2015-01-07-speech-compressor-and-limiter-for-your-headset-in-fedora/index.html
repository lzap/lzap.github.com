<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Speech compressor and limiter for your headset in Fedora</title><meta name=description content="engineer in pyjama"><meta name=keywords content="blog,lzap,lukáš,zapletal,linux,tech,fedora"><meta property="og:url" content="https://blog.zapletalovi.com/posts/2015-01-07-speech-compressor-and-limiter-for-your-headset-in-fedora/"><meta property="og:type" content="website"><meta property="og:title" content="Speech compressor and limiter for your headset in Fedora"><meta property="og:description" content="engineer in pyjama"><meta property="og:image" content="/images/avatar_rh_512.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Speech compressor and limiter for your headset in Fedora"><meta name=twitter:description content="engineer in pyjama"><meta property="twitter:domain" content="https://blog.zapletalovi.com/posts/2015-01-07-speech-compressor-and-limiter-for-your-headset-in-fedora/"><meta property="twitter:url" content="https://blog.zapletalovi.com/posts/2015-01-07-speech-compressor-and-limiter-for-your-headset-in-fedora/"><meta name=twitter:image content="/images/avatar_rh_512.jpg"><link rel=canonical href=https://blog.zapletalovi.com/posts/2015-01-07-speech-compressor-and-limiter-for-your-headset-in-fedora/><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://blog.zapletalovi.com/css/dark.css><script src=https://blog.zapletalovi.com/js/svg-injector.min.js></script>
<script src=https://blog.zapletalovi.com/js/feather-icons.min.js></script>
<script src=https://blog.zapletalovi.com/js/main.js></script>
<script type=text/javascript>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-16034952-1"]),_gaq.push(["_trackPageview"]),function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}()</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.zapletalovi.com><img src=https://blog.zapletalovi.com/images/avatar_rh_512.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.zapletalovi.com>Lukáš Zapletal</a></div><div class=nav-links><div class=nav-link><a href=https://blog.zapletalovi.com/posts/>Posts</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/me/>About me</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/contact/>Contact</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/tags/>Tags</a></div><div class=nav-link><a href=https://github.com/lzap><span data-feather=github></span></a></div><div class=nav-link><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></div><div class=nav-link><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></div><div class=nav-link><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></div><div class=nav-link><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.zapletalovi.com/posts/>Posts</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/me/>About me</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/contact/>Contact</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/tags/>Tags</a></li><li class=nav-item><a href=https://github.com/lzap><span data-feather=github></span></a></li><li class=nav-item><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></li><li class=nav-item><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></li><li class=nav-item><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></li><li class=nav-item><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Speech compressor and limiter for your headset in Fedora</h1><small role=doc-subtitle></small><p class=post-date>January 7, 2015</p><ul class=post-tags><li class=post-tag><a href=https://blog.zapletalovi.com/tags/linux>linux</a></li><li class=post-tag><a href=https://blog.zapletalovi.com/tags/fedora>fedora</a></li></ul></div><div class=post-content><p><p>Last couple of months I&rsquo;ve been using Google Hangouts and Bluejeans
conferencing technologies more than my VoIP phone. I got used to crisp and
clear voice from my Polycom and Platronics headset so I had a question.</p><p>Is it possible to achieve the same with my cheap USB Logitech headset which I
use for this purpose? The obvious answer is &ndash; yes.</p><p>This is tutorial how to setup PulseAudio in Fedora 20+ with LADSPA plugins to
improve audio experiences for conferences. It works best if you have a
dedicated audio interface (e.g. USB headset) so you don&rsquo;t need to play around
with the configuration every time you start your conference. This setup is
definitely not good for listening music!</p><p>What we need? Just couple of LADSPA audio plugins. Install them with:</p><pre><code>yum -y install ladspa-swh-plugins
</code></pre><p>Our goal today is to improve volume with two well-known audio technique called
signal compression. We will be using two plugins for that: a compressor and a
limiter (which is technically also a compressor). Both are distributed in the
package we have installed:</p><pre><code>$ analyseplugin /usr/lib64/ladspa/dyson_compress_1403.so

Plugin Name: &quot;Dyson compressor&quot;
Plugin Label: &quot;dysonCompress&quot;
Plugin Unique ID: 1403
Maker: &quot;Steve Harris &lt;steve@plugin.org.uk&gt;&quot;
Copyright: &quot;GPL&quot;
Must Run Real-Time: No
Has activate() Function: Yes
Has deactivate() Function: No
Has run_adding() Function: Yes
Environment: Normal or Hard Real-Time
Ports:  &quot;Peak limit (dB)&quot; input, control, -30 to 0, default 0
        &quot;Release time (s)&quot; input, control, 0 to 1, default 0.25
        &quot;Fast compression ratio&quot; input, control, 0 to 1, default 0.5
        &quot;Compression ratio&quot; input, control, 0 to 1, default 0.5
        &quot;Input&quot; input, audio
        &quot;Output&quot; output, audio

$ analyseplugin /usr/lib64/ladspa/fast_lookahead_limiter_1913.so

Plugin Name: &quot;Fast Lookahead limiter&quot;
Plugin Label: &quot;fastLookaheadLimiter&quot;
Plugin Unique ID: 1913
Maker: &quot;Steve Harris &lt;steve@plugin.org.uk&gt;&quot;
Copyright: &quot;GPL&quot;
Must Run Real-Time: No
Has activate() Function: Yes
Has deactivate() Function: No
Has run_adding() Function: Yes
Environment: Normal or Hard Real-Time
Ports:  &quot;Input gain (dB)&quot; input, control, -20 to 20, default 0
        &quot;Limit (dB)&quot; input, control, -20 to 0, default 0
        &quot;Release time (s)&quot; input, control, 0.01 to 2, default 0.5075
        &quot;Attenuation (dB)&quot; output, control, 0 to 70
        &quot;Input 1&quot; input, audio
        &quot;Input 2&quot; input, audio
        &quot;Output 1&quot; output, audio
        &quot;Output 2&quot; output, audio
        &quot;latency&quot; output, control
</code></pre><p>Long story short, a compressor filter is able to gain volume of a signal in a
dynamic way. Quiet portions of the stream will be boosted more than loud
portions. This ratio can be configured as well as peak limit and release time
of the limitation phase.</p><p>A limiter is basically high-ratio compressor which is used to hard-limit
signal that is too loud. It is often used as the very last plugin to make sure
you are getting the loudest signal possible, but not too high.</p><p>In other words, a person who talks quiet will be boosted on volume while loud
conference attendees will be limited. That&rsquo;s what we want.</p><p>In traditional setup, application sends the stream to the PulseAudio which
sends it directly to the audio card:</p><pre><code>Application -&gt; PulseAudio -&gt; Headset
</code></pre><p>We want to achieve the following setup:</p><pre><code>Application -&gt; PulseAudio -&gt; Compressor -&gt; Limiter -&gt; Headset
</code></pre><p>With the LADSPA plugins we just installed this is a piece of cake. Before we
start, we need to find out audio interface we want to &ldquo;enhance&rdquo;. In my case,
this is the Logitech USB headset:</p><pre><code>$ pacmd list-sinks | grep name:
name: &lt;alsa_output.pci-0000_00_1b.0.analog-stereo&gt;
name: &lt;alsa_output.usb-Logitech_Logitech_USB_Headset-00-Headset.analog-stereo&gt;
</code></pre><p>Now, to create those filters, just type in the following commands:</p><pre><code>pacmd load-module module-ladspa-sink sink_name=ladspa_output.fast_lookahead_limiter_1913.fastLookaheadLimiter master=alsa_output.usb-Logitech_Logitech_USB_Headset-00-Headset.analog-stereo plugin=fast_lookahead_limiter_1913 label=fastLookaheadLimiter control=0,-10,0.25

pacmd load-module module-ladspa-sink sink_name=ladspa_output.dyson_compress_1403.dysonCompress master=ladspa_output.fast_lookahead_limiter_1913.fastLookaheadLimiter plugin=dyson_compress_1403 label=dysonCompress control=0,1,0.5,0.99
</code></pre><p>Note you need to make sure the master is set to the name of your output device
(in my case the Logitech USB thing). That&rsquo;s really it. Now, startup the
PulseAudio mixer:</p><pre><code>pavucontrol
</code></pre><p>Start up your conferencing software (or if it&rsquo;s that a plugin in a browser)
and redirect the output on the Playback tab to &ldquo;Dyson Compressor&rdquo;. You should
immediately hear the difference - everything should be louder. You will likely
hear more background noise - this is expected.</p><p>Having the mixed opened, head over to Output Devices to see how signal is
being boosted and limited. You should see the input monitors on the two filter
plugins and the output.</p><p>If you want to tune up parameters, just unload the module and try again:</p><pre><code>pacmd list-modules
pacmd unload-module XYZ
</code></pre><p>When you are happy with this, put these two lines in the
/etc/pulse/default.pa (skip the &ldquo;pacmd&rdquo; command) and you are good to go.
PulseAudio will remember your setting per application, so you can route
particular applications or plugins through this setup.</p><p>If you want to play more with this, there are LADSPA plugins for noise
cancellation and equalizer to cut off low and high frequencies to clean out
speech. Share your setup with me in the comments bellow.</p></p></div></div></main><footer class=footer><span>&copy; 2022 Lukáš Zapletal, CC BY 4.0</span>
<span>Built with <a href=https://gohugo.io>hugo</a>, template <a target=_blank href=https://github.com/526avijitgupta/gokarna>gokarna</a></span></footer></body></html>