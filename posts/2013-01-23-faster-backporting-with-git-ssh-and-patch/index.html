<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Faster backporting with git, ssh and patch</title><meta name=description content="engineer in pyjama"><meta name=keywords content="blog,lzap,lukáš,zapletal,linux,tech,fedora,git"><meta property="og:url" content="https://blog.zapletalovi.com/posts/2013-01-23-faster-backporting-with-git-ssh-and-patch/"><meta property="og:type" content="website"><meta property="og:title" content="Faster backporting with git, ssh and patch"><meta property="og:description" content="engineer in pyjama"><meta property="og:image" content="/images/avatar_rh_512.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Faster backporting with git, ssh and patch"><meta name=twitter:description content="engineer in pyjama"><meta property="twitter:domain" content="https://blog.zapletalovi.com/posts/2013-01-23-faster-backporting-with-git-ssh-and-patch/"><meta property="twitter:url" content="https://blog.zapletalovi.com/posts/2013-01-23-faster-backporting-with-git-ssh-and-patch/"><meta name=twitter:image content="/images/avatar_rh_512.jpg"><link rel=canonical href=https://blog.zapletalovi.com/posts/2013-01-23-faster-backporting-with-git-ssh-and-patch/><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://blog.zapletalovi.com/css/main.css><link disabled id=dark-theme rel=stylesheet href=https://blog.zapletalovi.com/css/dark.css><script src=https://blog.zapletalovi.com/js/svg-injector.min.js></script>
<script src=https://blog.zapletalovi.com/js/feather-icons.min.js></script>
<script src=https://blog.zapletalovi.com/js/main.js></script>
<script type=text/javascript>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-16034952-1"]),_gaq.push(["_trackPageview"]),function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)}()</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://blog.zapletalovi.com><img src=https://blog.zapletalovi.com/images/avatar_rh_512.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://blog.zapletalovi.com>Lukáš Zapletal</a></div><div class=nav-links><div class=nav-link><a href=https://blog.zapletalovi.com/posts/>Posts</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/me/>About me</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/contact/>Contact</a></div><div class=nav-link><a href=https://blog.zapletalovi.com/tags/>Tags</a></div><div class=nav-link><a href=https://github.com/lzap><span data-feather=github></span></a></div><div class=nav-link><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></div><div class=nav-link><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></div><div class=nav-link><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></div><div class=nav-link><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://blog.zapletalovi.com/posts/>Posts</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/me/>About me</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/contact/>Contact</a></li><li class=nav-item><a href=https://blog.zapletalovi.com/tags/>Tags</a></li><li class=nav-item><a href=https://github.com/lzap><span data-feather=github></span></a></li><li class=nav-item><a href=https://mastodon.social/@lzap><img class=svg-inject src=/svg/icons/mastodon.svg></a></li><li class=nav-item><a href=https://twitter.com/lzap><span data-feather=twitter></span></a></li><li class=nav-item><a href=https://www.buymeacoffee.com/lzap><span data-feather=coffee></span></a></li><li class=nav-item><a href=https://blog.zapletalovi.com/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Faster backporting with git, ssh and patch</h1><small role=doc-subtitle></small><p class=post-date>January 23, 2013</p><ul class=post-tags><li class=post-tag><a href=https://blog.zapletalovi.com/tags/linux>linux</a></li><li class=post-tag><a href=https://blog.zapletalovi.com/tags/fedora>fedora</a></li><li class=post-tag><a href=https://blog.zapletalovi.com/tags/git>git</a></li></ul></div><div class=post-content><p><p>If you wort at Red Hat, be prepared to backport stuff. This is why customers
pay us - they want stable releases with fixed bugs. So while working on new
features upstream, we also fix bugs in released products.</p><p><em>Interested in working at Red Hat? Contact me! ;-)</em></p><p>More info at: <a href=http://jobs.redhat.com>http://jobs.redhat.com</a></p><p>The way we work in our team is to fix everything in the upstream project first
(for me this is Katello - <a href=https://www.katello.org>www.katello.org</a>) and then to cherry pick fixes
into internal branch which we build our product from (for me this is
CloudForms System Engine). Except security bugs which are still under embargo
of course.</p><p><em>CloudForms System Engine is component of CloudForms solution by Red Hat for
monitoring and updating running systems across physical, virtual, and cloud
environments. It ensures compliance of content and configurations, as well as
Red Hat entitlements. CloudForms System Engine works with CloudForms Cloud
Engine by supplying content required to build images and deploy them across
the cloud.</em></p><p>More info at: <a href=http://www.redhat.com/products/cloud-computing/cloudforms/>http://www.redhat.com/products/cloud-computing/cloudforms/</a></p><p>For bugs which can be reproduced upstream first this is pretty
straightforward. But there can be troubles when working on bugs which can be
only reproduced on the product.</p><p>At the first stage, I usually edit files directly on my testing instance where
I reproduced it. Then I need to write a patch for upstream and backport it.
And this is the time I often need to cherry pick into internal, rebuild
product, install it, restart. Pretty time consuming.</p><p>So this is what I sometimes use - maybe you find it useful. When I have the
patch ready and tested with upstream in my git (staged for commit), I can
remotely patch my instance using this command:</p><pre><code>katello_git# git diff | ssh repro.lan &quot;patch -p2 -d /usr/share/katello&quot;
</code></pre><p>If the patch applies fine, great. If not, you usually need to correct some
blocks (patch creates rejected blocks as .rej files by default), restart and
test the patch.</p><p>If I need to re-patch, I usually do this:</p><pre><code>repro.lan# rpm -qV katello
S.5....T.    /usr/share/katello/app/controllers/api/api_controller.rb

repro.lan# yum reinstall katello
repro.lan# rpm -qV katello
</code></pre><p>Now the product is ready to be patched again. I was using contra-patching, but
it does not work well when you merge changes manually.</p><p>You can use both git diff or git am (if you have already commited something).
Depends on your git workflow.</p><p>Maybe this can be helpful for you somehow. ;-)</p></p></div></div></main><footer class=footer><span>&copy; 2022 Lukáš Zapletal, CC BY 4.0</span>
<span>Built with <a href=https://gohugo.io>hugo</a>, template <a target=_blank href=https://github.com/526avijitgupta/gokarna>gokarna</a></span></footer></body></html>